### 1. Undo Log（回滚日志）

- **作用**：记录数据被修改前的值。
- **用途**：
  - 事务回滚：`撤销`未提交事务的操作，保证原子性。
  - 一致性读：支持 `MVCC`，读到历史版本数据。
- **存储位置**：InnoDB 表空间（ibd 文件）或独立 undo 表空间。
- **工作流程**：
  - 修改数据前，先写 undo log。
  - 回滚时，用 undo log 恢复原值。

undolog 两个功能合成了一个 -> 撤销+历史版本

---

### 2. Redo Log（重做日志）

WAL

- **作用**：记录数据被修改后的值（物理页的变化）。
- **用途**：
  - 崩溃恢复：系统宕机后，重做已提交事务的操作，保证持久性。
- **存储位置**：InnoDB 独立的 redo log 文件（ib_logfile0, ib_logfile1）。
- **工作流程**：
  - 修改数据时，先写 redo log，再写内存，最后异步刷盘。
  - 崩溃时，用 redo log 恢复到最新已提交状态。

---

### 3. Binlog（二进制日志）

- **作用**：记录所有对数据库有更改的 SQL 语句或行变更（逻辑日志）。
- **用途**：
  - 主从复制：从库通过 binlog 同步数据。
  - 数据恢复：基于 binlog 做增量恢复。
- **存储位置**：MySQL Server 层的 binlog 文件（如 mysql-bin.000001）。
- **工作流程**：
  - 事务提交时，先写 binlog，再写 redo log（两阶段提交）。
  - 支持多种格式（statement/row/mixed）。

---

### 总结口诀

- **Undo**：撤销未提交，保证原子性和一致性读;MVCC.
- **Redo**：崩溃重做，保证持久性。
- **Binlog**：记录操作，支持复制和恢复。

Undo 回滚前，Redo 重做后，Binlog 记操作，三者各有用。
