正在收集工作区信息# 分布式数据库系统笔记

基于[CMU 15-445/645 数据库系统](https://15445.courses.cs.cmu.edu/fall2022/slides/)课程，这个文件包含了关于分布式数据库系统的重要概念和设计。以下是关键内容的总结：

## 一、并行系统 vs. 分布式系统

两者的主要区别：

| 并行 DBMS                | 分布式 DBMS            |
| ------------------------ | ---------------------- |
| 节点物理上相互靠近       | 节点可能相距较远       |
| 通过高速互连通信         | 通过较慢的公共网络通信 |
| 通信成本被假定为低且可靠 | 通信成本和问题不可忽视 |

## 二、系统架构

分布式 DBMS 的系统架构决定了 CPU 之间如何协调以及在哪里检索/存储数据库对象：

### 1. 共享内存 (Shared Memory)

- CPU 通过快速互连访问公共内存地址空间
- 每个处理器对所有内存数据结构有全局视图

### 2. 共享磁盘 (Shared Disk)

- 所有 CPU 可通过互连直接访问单个逻辑磁盘，但各自有私有内存
- 存储层和执行层可独立扩展
- 例如：Oracle RAC

### 3. 无共享 (Shared Nothing)

- 每个 DBMS 实例有自己的 CPU、内存和本地磁盘
- 节点只通过网络通信
- 扩展性较难但性能和效率更好
- 例如：大多数分布式数据库系统

## 三、数据分区策略

### 1. 表级分区

- 将整个表分配给单个节点
- 假设每个节点有足够存储空间容纳整张表
- 适合不跨表连接查询和访问模式均匀的场景

### 2. 垂直分区

- 按照属性(列)拆分表
- 必须存储元组信息以重建原始记录

### 3. 水平分区 (分片/Sharding)

- 基于某些分区键将表的元组拆分为不相交的子集
- 分区方案包括：
  - **哈希分区**：均匀分布数据，但不适合范围查询
  - **范围分区**：适合范围查询，但可能导致热点
  - **谓词分区**：基于条件表达式

### 4. 一致性哈希 (Consistent Hashing)

- 解决普通哈希在节点增减时大量数据迁移的问题
- 减少在节点变化时需要重新映射的键数量
- 在分布式缓存和 NoSQL 系统中广泛使用

## 四、事务协调

分布式环境中处理事务的两种方法：

### 1. 中心化协调器

- 全局"交通警察"控制事务
- 例如：TP Monitor，X/Open XA 标准

### 2. 去中心化协调器

- 节点自组织协调事务
- 通常一个节点被选为临时领导者

## 五、分布式并发控制

允许多个事务在多个节点上同时执行，面临的挑战：

- 数据复制
- 网络通信开销
- 节点故障
- 时钟偏移

分布式 2PL（两阶段锁定）需要处理跨节点锁请求和死锁检测。

---

分布式数据库系统是一个复杂的话题，结合了数据库、分布式系统和并行计算的多个方面。深入理解这些概念对于设计和维护大规模分布式数据应用至关重要。
