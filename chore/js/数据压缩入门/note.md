# 数据压缩入门

https://book.douban.com/subject/35034359/
https://meiling-li.blog.csdn.net/article/details/133526263
https://blog.csdn.net/wyll19980812/article/details/120248186
https://fuzhe1989.github.io/2020/10/09/understanding-compression/

---

好的，我们来详细讲解一下《数据压缩入门》（原名 _Understanding Data Compression_）这本书。

这本书由 Colt McAnlis 和 Aleks Haecky 撰写，是一本非常经典的数据压缩领域入门读物。它的最大特点是**避开了复杂深奥的数学理论，用直观、易懂的方式和丰富的图例来解释数据压缩的核心思想和常用算法**。它非常适合初学者、开发者以及任何对“文件为什么能变小”这个问题感到好奇的人。

### 本书核心内容概览

这本书主要围绕两个核心问题展开：

1.  **数据为什么可以被压缩？** (信息论基础)
2.  **数据是如何被压缩的？** (主流压缩算法)

全书可以分为三大块：**基础理论、无损压缩、有损压缩**。

---

### 第一部分：基础与核心思想

在正式介绍算法前，本书会铺垫一些基本概念，这是理解后续所有内容的关键。

- **信息熵 (Entropy)**：这是数据压缩的理论基石。书中会用通俗的例子解释，一个文件中信息的“不确定性”或“意外程度”越高，其信息熵就越大，也就越难被压缩。反之，充满重复和规律（冗余）的数据，信息熵低，压缩潜力就大。数据压缩的本质就是**消除冗余**。
- **压缩模型 (Modeling) 与编码 (Coding)**：
  - **模型**：负责发现和描述数据中的规律和冗余。例如，模型可能会发现“the”这个词在文本中频繁出现。
  - **编码**：利用模型发现的规律，将数据转换成更紧凑的格式。例如，用一个很短的符号来代替“the”。
  - 几乎所有的压缩算法都可以看作是“模型 + 编码”的组合。

---

### 第二部分：无损压缩 (Lossless Compression)

无损压缩意味着解压后的数据与原始数据**完全一致**，100% 还原。它适用于文本、程序代码、数据库等任何不允许信息丢失的场景。

书中重点讲解了以下几种主流的无损压缩算法：

1.  **字典算法 (Dictionary-based)**：这是最核心、最常用的一类算法。

    - **核心思想**：在处理数据时，建立一个“字典”来存储之前出现过的字符串。当再次遇到相同的字符串时，不再存储它本身，而是存储一个指向字典中该位置的“引用”（通常是“距离+长度”对）。
    - **代表算法**：
      - **LZ77 (Lempel-Ziv 1977)**：使用“滑动窗口”作为动态字典。这是理解 `Gzip`, `Deflate`, `PNG` 等现代压缩格式的关键。书中会用非常清晰的图示一步步展示滑动窗口是如何工作的。
      - **LZ78 及其变体 (如 LZW)**：构建一个显式的字典树。`GIF` 和 `TIFF` 图片格式就使用了 LZW 算法。

2.  **熵编码算法 (Entropy-based)**：这类算法关注的是单个符号的出现频率。
    - **核心思想**：为出现频率高的符号分配更短的编码，为出现频率低的符号分配更长的编码，从而在总体上缩短编码长度。
    - **代表算法**：
      - **霍夫曼编码 (Huffman Coding)**：一个经典且直观的算法。书中会教你如何根据符号频率构建霍夫曼树，并生成对应的编码。`Deflate` 算法（Gzip 的核心）就是 LZ77 和霍夫曼编码的组合。
      - **算术编码 (Arithmetic Coding)**：比霍夫曼编码更先进、压缩率通常也更高。它将整个输入数据表示为 0 到 1 之间的一个小数。虽然理论上更优，但因其复杂性和专利问题，在早期没有霍夫曼编码流行。

---

### 第三部分：有损压缩 (Lossy Compression)

有损压缩会**永久性地丢弃**一部分数据，因此解压后的数据与原始数据不完全相同，但人眼或人耳难以察觉其差异。它广泛应用于图像、音频和视频领域。

书中主要介绍了这些媒体的压缩原理：

1.  **图像压缩 (以 JPEG 为例)**：

    - **核心思想**：利用人眼对亮度的敏感度高于对色度的敏感度，以及对高频细节不敏感的特点。
    - **压缩步骤**：
      1.  **色彩空间转换**：从 RGB 转换到 YCbCr（亮度、蓝色差、红色差）。
      2.  **离散余弦变换 (DCT)**：将图像块从空间域转换到频率域，将能量集中在少数低频系数上。
      3.  **量化 (Quantization)**：**这是有损的关键步骤**。通过粗暴地舍弃高频部分的精度（通常是除以一个较大的数后取整），大量的数据变成了 0。
      4.  **熵编码**：最后对量化后的系数进行无损压缩（通常是霍夫曼编码）。

2.  **音频压缩 (以 MP3 为例)**：

    - **核心思想**：利用“心理声学模型”。丢弃那些人耳听不到的声音，例如被一个很响的声音所“掩蔽”的微弱声音。
    - 书中会解释什么是“掩蔽效应”，以及 MP3 是如何利用这个原理来决定哪些音频数据可以被安全地丢弃。

3.  **视频压缩 (以 MPEG 为例)**：
    - **核心思想**：视频是连续的图像序列，相邻帧之间存在巨大的时间冗余。
    - **压缩技术**：
      - **帧内压缩 (Intra-frame)**：对关键帧（I-frame）使用类似 JPEG 的图像压缩技术。
      - **帧间压缩 (Inter-frame)**：对于后续的预测帧（P-frame）和双向预测帧（B-frame），不存储完整的图像，只存储它与前/后参考帧之间的**差异**和**运动矢量 (Motion Vector)**。

### 总结

《数据压缩入门》是一本“授人以渔”的书。它不会让你立即成为压缩算法专家，但能为你建立一个坚实且直观的知识框架。读完这本书，你将能够：

- 理解常见文件格式（如 `ZIP`, `Gzip`, `PNG`, `JPEG`, `MP3`, `MP4`）背后的工作原理。
- 在面对具体应用场景时，能够判断应该使用无损压缩还是有损压缩。
- 为进一步深入学习更高级的压缩技术（如 Brotli, Zstandard, AV1 等）打下良好基础。

总而言之，如果你想弄懂数据压缩的“魔法”，但又不想被复杂的数学公式劝退，这本书是绝佳的起点。
