### 4.1 矩阵加法与乘法 (Addition and Multiplication)

- **矩阵加法**：
  两个 $n \times m$ 矩阵 $A$ 和 $B$ 相加，结果 $C$ 的元素为 $c_{ij} = a_{ij} + b_{ij}$。
  - **时间复杂度**：$O(n \times m)$。
- **标准矩阵乘法**：
  若 $A$ 是 $n \times p$ 矩阵，$B$ 是 $p \times m$ 矩阵，则 $C = A \times B$ 是 $n \times m$ 矩阵，其中：
  $$c_{ij} = \sum_{k=1}^{p} a_{ik} \cdot b_{kj}$$
  - **时间复杂度**：$O(n \cdot p \cdot m)$，对于 $n \times n$ 方阵为 $O(n^3)$。
  - **计算特性**：具有结合律 $(AB)C = A(BC)$，但不满足交换律 $AB \neq BA$。

### 4.2 稠密矩阵数据结构 (Dense Matrix Data Structures)

稠密矩阵是指非零元素占绝大多数的矩阵。

- **存储方式**：通常使用二维数组存储。
- **内存布局**：
  - **行优先 (Row-major)**：C/C++ 默认。内存中连续存储每一行。索引 $(i, j)$ 对应地址：`base + i * cols + j`。
  - **列优先 (Column-major)**：Fortran/MATLAB 默认。内存中连续存储每一列。
- **优缺点**：支持 $O(1)$ 随机访问，但对于大规模稀疏数据会浪费大量空间。

### 4.3 稀疏矩阵数据结构 (Sparse Matrix Data Structures)

当矩阵中绝大多数元素为零时，使用稀疏存储以节省空间（仅存储非零元素 NNZ）。

- **三元组 (COO - Coordinate List)**：
  存储 `(row, col, value)` 列表。简单但不易于数学运算。
- **压缩稀疏行 (CSR - Compressed Sparse Row)**：
  最常用的格式，由三个数组组成：
  1.  `values`: 存储所有非零元素的值。
  2.  `column_indices`: 存储每个非零元素对应的列索引。
  3.  `row_pointers`: 存储每一行在 `values` 数组中的起始偏移量。
  - **优点**：高效支持矩阵-向量乘法 ($Ax$)。
- **压缩稀疏列 (CSC)**：与 CSR 类似，但按列压缩，适合列切片操作。

### 4.4 快速矩阵乘法与 Strassen 算法

Strassen 算法通过分治法打破了 $O(n^3)$ 的限制。

- **核心思想**：
  将 $n \times n$ 矩阵分解为 4 个 $(n/2) \times (n/2)$ 的子矩阵。标准分治需要 8 次子矩阵乘法，而 Strassen 构造了 7 个中间矩阵 $P_1 \dots P_7$，仅需 **7 次乘法**和若干次加法。
- **复杂度**：
  $$T(n) = 7T(n/2) + O(n^2)$$
  根据主定理，时间复杂度为 $O(n^{\log_2 7}) \approx O(n^{2.81})$。
- **实际应用**：
  - 由于递归开销和常数项较大，Strassen 仅在 $n$ 较大（通常 $n > 100$）时才比标准算法快。
  - 它对数值稳定性略有影响。

#### 示例：CSR 结构的简单表示

```python
# 矩阵:
# [ 10,  0,  0 ]
# [  0, 20, 30 ]
# [  0,  0, 40 ]

values = [10, 20, 30, 40]
column_indices = [0, 1, 2, 2]
row_pointers = [0, 1, 3, 4] # row_pointers[i+1] - row_pointers[i] 是第 i 行的非零个数
```
