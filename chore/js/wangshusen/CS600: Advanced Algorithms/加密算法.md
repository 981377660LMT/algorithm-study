### 18.1 RSA 算法

RSA 是最著名的公钥加密算法，其安全性基于**大整数分解问题**的困难性。

- **密钥生成步骤**：
  1.  随机选择两个大素数 $p$ 和 $q$。
  2.  计算 $n = p \times q$，其欧拉函数 $\phi(n) = (p-1)(q-1)$。
  3.  选择一个整数 $e$，满足 $1 < e < \phi(n)$ 且 $\gcd(e, \phi(n)) = 1$（通常选 65537）。
  4.  计算 $d$，使得 $e \cdot d \equiv 1 \pmod{\phi(n)}$（使用扩展欧几里得算法）。
  - **公钥**：$(e, n)$；**私钥**：$(d, n)$。
- **加密与解密**：
  - 加密：$C = M^e \pmod n$
  - 解密：$M = C^d \pmod n$
- **数学原理**：基于欧拉定理 $M^{\phi(n)} \equiv 1 \pmod n$。

### 18.2 数字签名 (Digital Signature)

数字签名用于确认消息的真实性（身份验证）和完整性，并提供不可否认性。

- **核心流程**：
  1.  **签名**：发送方使用哈希函数对消息 $M$ 生成摘要 $h = H(M)$，然后用自己的**私钥**对 $h$ 进行加密，生成签名 $S$。
  2.  **验证**：接收方收到 $(M, S)$ 后，用发送方的**公钥**解密 $S$ 得到 $h'$，同时计算 $H(M)$。若两者一致，则签名有效。
- **与加密的区别**：加密是公钥加密、私钥解密（保证机密性）；签名是私钥签名、公钥验证（保证真实性）。

### 18.3 同态加密 (Homomorphic Encryption)

同态加密允许直接对**密文**进行运算，其结果解密后等同于对明文进行相应运算的结果。

- **数学定义**：
  若加密函数为 $E$，则满足 $E(m_1) \circ E(m_2) = E(m_1 \cdot m_2)$。
- **分类**：
  - **部分同态 (PHE)**：仅支持加法（如 Paillier 算法）或仅支持乘法（如未经填充的 RSA）。
  - **某种同态 (SWHE)**：支持有限次数的加法和乘法。
  - **全同态 (FHE)**：支持任意次数的加法和乘法。2009 年由 Craig Gentry 首次提出，基于格（Lattice）理论。
- **应用场景**：云计算隐私保护。用户可以将加密数据传给云端，云端在不解密的情况下进行数据分析并返回加密结果。

#### 示例：RSA 核心逻辑模拟

```python
# 简化的 RSA 逻辑演示
def rsa_demo():
    # 1. 选素数 (实际应用中需极大)
    p, q = 61, 53
    n = p * q
    phi = (p - 1) * (q - 1)

    # 2. 公钥 e
    e = 65537

    # 3. 私钥 d (使用 pow 的三参数版本计算模逆)
    d = pow(e, -1, phi)

    # 消息 M
    msg = 42
    # 加密
    cipher = pow(msg, e, n)
    # 解密
    decrypted = pow(cipher, d, n)

    return cipher, decrypted
```
