这节课的内容是推荐系统涨指标的方法。具体讲解如何通过改进召回模型（retrieval models）来提升推荐系统的核心指标。这节课的内容分三部分：双塔模型、Item-to-Item (I2I)、还有小众的召回模型（比如 PDN、Deep Retrieval、SINE、M2GRL）。

---

这节课是“推荐系统涨指标”系列的第一篇实战课，专注于**召回 (Retrieval/Recall)** 阶段。
召回是推荐系统的“塔基”，它决定了最终推荐列表的**上限**。如果召回没把用户喜欢的东西捞回来，排序做得再好也没用。

以下是对这节课内容的深度逻辑拆解与总结：

### 1. 核心制约因素：召回配额 (Quota)

在工业界，受限于计算资源（主要是粗排 Pre-Ranking 的压力），召回的总量是锁死的。

- _现状_：比如总共给粗排送 5000 个物品。
- _问题_：几十条召回通道（双塔、ItemCF、Graph...）要抢这 5000 个名额。
- _策略_：**Zero-Sum Game (零和博弈)**。
  - 简单的增加新召回通道（不优化旧的）= 挤占别人的份额。
  - **涨指标的逻辑**：引入**更高质量**的召回源（High Quality Sources），替换掉**低质量**的配额。虽然总数还是 5000，但含金量变高了，大盘指标自然就涨了。

### 2. 双塔模型 (Two-Tower Model) 的优化路线

双塔是当前最重要的召回模型，占据了最大的配额。优化双塔是 ROI 最高的手段。

#### A. 样本优化 (Sample Selection)

- **简单正样本**：点过的 (Click)。
- **简单负样本**：随机采样的 (Random)。
- **困难负样本 (Hard Negatives) —— _提分利器_**：
  - _定义_：被召回了，但在排序阶段被打分很低、被淘汰的物品。
  - _逻辑_：这些物品虽然有些像（能骗过简单的召回），但并不是用户真正想要的。把它们喂给模型当负样本，能极大地提升模型的分辨能力。

#### B. 结构优化 (Model Architecture)

- **全连接 $\rightarrow$ DCN (Deep Cross Network)**：引入特征交叉，增强表达。
- **引入行为序列**：把用户最近交互的 $N$ 个物品 Embedding 均值扔进用户塔。
- **多向量模型 (Multi-Vector / Multi-Head)**：
  - _痛点_：标准双塔 User 塔只出一个向量，很难同时满足“我想看美女”和“我想学英语”的多样化需求。
  - _做法_：User 塔吐出 $K$ 个向量（比如 10 个），分别去检索，以此捕捉用户的多兴趣（Multi-Interest）。
  - _注_：Item 塔还是只出一个向量（为了省索引成本）。

#### C. 训练优化 (Training)

- **Batch 内负采样 + 纠偏**：解决热门物品 dominate 的问题。
- **自监督学习 (Self-Supervised Learning)**：专门拯救长尾/冷门物品的 Embedding 学习，防止它们还没被学好就被淘汰。

### 3. Item-to-Item (I2I) 的优化路线

I2I 是存量时代最稳的召回方式，“看了又看”。

- **多路并举 (Ensemble)**：
  - ItemCF、Swing、Online Swing... 这些算法虽然原理相似，但召回结果差异挺大。
  - _策略_：不要只用一个 Swing 召回 1000 个。不如 Swing 召回 250 + ItemCF 召回 250 + Embedding I2I 召回 250... **混合使用效果通常优于单一算法**。
- **Embedding I2I**：
  - 用双塔学出来的 Item Embedding 算相似度，作为 I2I 的一路补充。

### 4. 小众但有效的召回 (Niche Models)

当主流模型（双塔、I2I）卷不动时，可以试试这些：

- **U2U2I (User-User-Item)**：基于相似用户推荐。
- **U2A2I (User-Author-Item)**：关注流召回（或者隐式关注）。
- **Graph/GNN**：PDN, DeepRetrieval, SimGNN 等。虽然配额小，但在捕捉复杂关系上有奇效。

### 5. 总结

在召回侧涨指标，本质上是在做**“资源置换”**：

1.  **精细化打磨双塔**（特别是困难负样本和多向量），提升“主力军”的战斗力。
2.  **组合拳打法**，同时上线多种 I2I 和 小众模型，让它们去竞争那有限的 5000 个坑位。
3.  **分人群配置**：新用户和老用户的召回配额比例应该截然不同（新用户多给热门/类目，老用户多给双塔/I2I）。
