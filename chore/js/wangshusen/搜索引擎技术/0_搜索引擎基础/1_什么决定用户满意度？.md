决定搜索引擎用户体验的主要因素为相关性、内容质量、时效性、个性化。
2:32 相关性：文档能满足查询词的需求，或回答查询词提出的问题。相关性是需求匹配，而非字面匹配。
5:02 内容质量：包括 EAT（专业性、权威性、可信赖）、文本质量、图片质量等很多分数。
12:36 时效性：分为突发时效性、一般时效性、周期时效性。
20:59 个性化：反映在预估用户点击和交互文档的概率。

---

基于王树森教授的《搜索引擎技术》第二讲视频教程，这一节课深入剖析了**决定搜索质量（与用户满意度）的四大支柱**：**相关性、内容质量、时效性和个性化**。

以下是针对这四大核心要素的深度技术拆解分析：

### 1. 相关性 (Relevance): 搜索的基石

这是搜索引擎存在的最基本前提。如果结果不相关，其他一切优化（如个性化、即时性）皆为徒劳。

- **定义逻辑**：相关性主要衡量 **Query (q)** 与 **Document (d)** 的语义匹配程度，是一个**客观标准**，不依赖于具体用户 (User agnostic)。
  - _示例_：搜索 "狄仁杰"，游戏角色、历史人物、影视作品均为相关内容。如果用户只想找游戏角色但搜到了历史，这是**个性化**问题，而非相关性问题。
- **计算模型分层**：
  - **召回海选 (Recall Selection)**：处理 10k+ 文档。使用低成本算法，如 TF-IDF、BM25、词类匹配 (Lexical Matching) 或轻量级双塔 BERT。
  - **粗排 (Pre-ranking)**：处理 ~1k 文档。使用双塔 BERT (Two-Tower) 或浅层交叉 BERT。双塔速度快但语义交互能力弱。
  - **精排 (Ranking)**：处理 ~100 文档。使用深层交叉 BERT (Cross-Encoder)，允许 Query 和 Doc 的 token 进行完整的 Attention 交互，精度最高但计算昂贵。

### 2. 内容质量 (Content Quality): 信任与体验

搜索引擎不仅要给“对”的结果，还要给“好”的结果。质量评估是**多维度评分体系**。

- **E-A-T (Google 标准)**：
  - **Expertise (专业性)**：作者是否有资质？（如医生写医疗文）。
  - **Authoritativeness (权威性)**：网站/机构的影响力（如 BBC 之于新闻，WHO 之于健康）。
  - **Trustworthiness (可信赖度)**：平台本身的口碑（如 Yelp、大众点评的真实评价）。
  - **YMYL (Your Money Your Life)**：对于涉及金钱、健康、法律等高风险 Query，E-A-T 权重会被极大调高。
- **文本质量 (Quality Level)**：
  - **文字本身**：文笔是否通顺、逻辑是否清晰（vs. 小学生作文）。
  - **意图判断**：是否包含欺诈、软广、仇恨言论（负向打压）。
  - **负面信号**：标题党 (Clickbait)、图文不符、关键词堆砌 (Keyword Stuffing)。
- **工程实现**：内容质量分数通常是**静态 (Static)** 的。在文档被索引时，异步调用 BERT/GPT/多模态模型离线计算好分数，存入 Feature Store，排序时直接读取，不消耗在线推理算力。

### 3. 时效性 (Timeliness/Freshness): 捕捉时间价值

核心难点在于**识别 Query 的时间意图**，而非单纯看文档发布时间。

- **意图分类**：
  1.  **突发时效性 (Breaking News)**：如“地震”、“明星出轨”。
      - _识别方法_：必须依赖**数据挖掘 (Data Mining)**，而非语义模型。监控搜索量激增 (Spikes)、社交媒体热榜。BERT 无法从字面推断“王力宏”今天有没有出瓜。
  2.  **一般时效性 (General Freshness)**：如“iPhone 评测”、“汇率”。
      - _识别方法_：语义模型 (Semantic Models) 擅长此类。从字面即可判断需要较新的信息，可分为强/中/弱/无四档。
  3.  **周期时效性 (Cyclical/Recurrent)**：如“春晚”、“双 11”。
      - _处理_：特定时间窗口内转化为突发时效性处理，其余时间为无时效性。

### 4. 个性化 (Personalization): 千人千面

在移动端 App 搜索中尤为重要，解决 Query 意图宽泛的问题。

- **逻辑**：当 Query 宽泛（如“头像”）时，召回结果巨大，需利用用户画像进行重排。当 Query 极精确（如“权力的游戏 龙妈头像”）时，个性化权重应降低。
- **核心手段**：**pCTR (Predicted CTR) / pCVR**。
  - 这与推荐系统技术栈完全复用。
  - **隐形价值**：即使不做显式个性化，CTR 模型也是一种**群体智慧**的投票。如果大家都点某个结果，说明它质量高、相关性好。CTR 模型能隐式地修正语义模型（BERT）的 Bad Case。

### 5. 课后思考题解析：PageRank 属于哪一类？

- **问题**：PageRank 属于相关性、权威性、文本质量、时效性、还是个性化？
- **答案**：**权威性 (Authoritativeness) / E-A-T 中的 Trustworthiness**。
- **解析**：
  - PageRank 基于网页链接图（Link Graph），核心逻辑是“被高质量网页引用的网页也是高质量的”。
  - 它**不是相关性**：高 PageRank 的页面（如 Google 首页）可能与你搜的 "红烧肉" 毫无语义关系。
  - 它衡量的是网站在网络拓扑中的**重要程度和影响力**，这正是权威性的定义。

### 总结

现代搜索引擎的排序公式可以简化理解为：
$$ Score = w_1 \cdot \text{BERT(Relevance)} + w_2 \cdot \text{Quality(Static)} + w_3 \cdot \text{Freshness(TimeFactor)} + w_4 \cdot \text{pCTR(Personalization)} $$
其中 $w$ 权重根据 Query 的意图分类动态调整（例如搜“感冒药”时 Quality 权重极高，搜“地震”时 Freshness 权重极高）。

---

### 核心思想：网页的“投票”机制

PageRank 的核心逻辑可以概括为一句话：**一个网页的重要性，取决于有多少个网页链接它，以及链接它的那些网页本身有多重要。**

### 原理拆解

1.  **链接即投票**

    - 如果网页 A 有一个链接指向网页 B，就相当于 A 投了 B 一票。
    - 票数（入链）越多，B 的排名越靠前。

2.  **权重不同**

    - 并不是所有票的价值都一样。
    - 来自“大 V”（高权重网页）的票，比来自“路人”（低权重网页）的票更有价值。
    - 如果 Google 官网链接了你的博客，这比几百个小论坛链接你的博客还要管用。

3.  **权重传递**
    - 一个网页会将自身的权重平均分给它链向的所有网页。
    - 如果 A 的权重是 10，它只有 2 个外链，那么每个链接分得 5 分。
    - 如果 A 的权重是 10，它有 100 个外链，那么每个链接只能分得 0.1 分（这也防止了链接工厂作弊）。

### 简化公式

$$PR(A) = (1 - d) + d \sum_{i=1}^{n} \frac{PR(T_i)}{C(T_i)}$$

- $PR(A)$: 网页 A 的 PageRank 值。
- $PR(T_i)$: 链接到 A 的网页 $T_i$ 的 PageRank 值（对方的权重）。
- $C(T_i)$: 网页 $T_i$ 的出链数量（它还要分给多少人）。
- $d$: **阻尼系数**（通常为 0.85）。模拟用户在点击链接时，有 15% 的概率不再继续点击，而是随机跳转到新网址（防止陷入死循环）。

### 总结

PageRank 是一个**递归**算法：你想知道 B 的权重，得先知道 A 的权重；想知道 A 的权重，得先计算链接 A 的其他网页的权重…… 系统通过不断迭代计算，直到所有网页的权重趋于稳定。
