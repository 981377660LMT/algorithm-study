# 14 意图识别：QP 里最“能撬大盘”的路由与策略开关

本章一句话点题：

> 最容易撬动搜索大盘指标的，一个是意图识别，一个是查询词改写。

意图识别（Intent Understanding）的独特之处是：

- 它不只是给排序模型提供一个特征
- 更关键的是：它能决定 **“走哪条下游链路 / 召回哪些通道 / 用什么排序策略”**

也就是路由与策略开关。

本章讨论的意图类型比较“工程向”：

- 时效性意图
- 地域性意图
- 用户名搜索意图
- 求购/电商意图

---

## 14.1 “影响下游链路调用”的意图：为什么它价值最大

当一个意图会改变召回/排序的结构，而不是仅仅改一个特征权重时，它的收益往往更大。

### 14.1.1 时效性意图 → 影响索引与年龄权重

QP 需要识别：

- 突发时效性
- 一般时效性（强/中/弱/无）
- 周期时效性

然后对下游的影响有两类：

1. **召回通道**：
   - 突发/强时效：优先从新文档（近线/实时）索引召回，不够再补全量索引
2. **排序策略**：
   - 年龄（doc age）权重随意图强度变化：意图越强，年龄权重越大

这与第 8 章的思想完全一致：先判“需不需要新”，再决定加权。

### 14.1.2 地域性意图 → 影响召回过滤、配额与混排

地域意图识别的三个关键维度（本章总结得很工程）：

1. **对距离是否敏感**
   - “附近美食”高度敏感
   - “周边游”更像“同城/可驾车”，不那么敏感
2. **意图强弱**
   - “附近的美食”强
   - “日料店”“星巴克”多意图：有人想附近，有人想全城
3. **显式 vs 隐式**
   - 显式：query 直接包含附近/同城/城市名
   - 隐式：query 没写，但语义上可能是本地需求

下游承接：

- 召回：按用户定位过滤距离阈值（阈值取决于敏感程度）
- 配额：附近 vs 全局文档比例取决于意图强弱
- 排序：距离与相关性/质量/时效/个性化融合
- 多意图 query：更推荐“多队列混排”（本地队列 + 全局队列）

### 14.1.3 用户名搜索意图 → 影响结果形态（账号卡片）

在内容社区（小红书/抖音/微博/知乎）里，用户会搜：

- 用户 ID
- 用户名
- 用户名片段

如果你只做“标题正文匹配”，就会错过真正需求：用户想找账号本人。

典型承接：

- 命中用户 ID：规则判断格式 + 在 ID 库命中 → 直接出账号卡片
- 用户名/片段：更难，ROI 高的方法是维护 KOL 用户名库，做完全/部分命中

### 14.1.4 求购/电商意图 → 影响召回索引与多队列融合

如果 QP 判定 query 有求购意图，搜索结果往往需要：

- 商品
- 店铺
- 直播
- - 一部分测评/内容

召回：

- 除内容索引，还要从商品/店铺/直播索引额外召回

排序：

- 多队列混排
- 商品排序的重要依据是“预估营收”（价格 × 转化率），与内容排序目标不同

工程含义：

- 一旦意图变成“交易”，目标函数就变了

---

## 14.2 你应该如何做意图系统：分层输出、可解释、可回滚

建议把意图系统当作 QP 的“策略中枢”，输出至少包含：

- 意图类型（time/local/user/commerce…）
- 意图强度（强/中/弱/无）
- 关键参数（例如距离阈值、同城范围、是否启用新索引、队列配额）

并且要能做到：

- 可解释：线上问题能快速定位“是不是意图误判”
- 可回滚：误判影响是结构性的（路由错），需要快速止损

---

## 14.3 常见坑与检查清单

- 把意图当特征：只调权重不改路由，收益会小
- 只识别显式词：隐式意图漏判会很严重
- 意图强弱不分：导致策略一刀切（例如所有本地 query 都强制附近）
- 多意图 query 处理不当：只出本地或只出全局都会伤一部分用户
- 求购意图漏判：内容结果再相关也无法满足“我要买”的需求

---

## 14.4 练习（建议动手）

1. 设计一个意图输出 schema：字段包含意图类型、强度、关键参数，并写出你会如何在召回/排序中消费这些字段。
2. 列出 100 条 query，标注它们的地域意图（显式/隐式、强/弱、附近/同城），并给出你用于判定的证据。
3. 设计“用户名意图”的最低 ROI 方案：你会维护怎样的 KOL 库？如何做部分命中？

---

## 14.5 与其它章节的连接

- 与第 8/9 章：时效/地域意图是下游路由与融合的前置条件
- 与第 15 章：改写与意图识别往往联动（属性检索、提问、地域改写）
- 与第 10 章：意图是 CTR/个性化的重要 query 侧特征，也决定是否启用某些序列特征
