# 8 时效性：不是“越新越好”，而是“该新才新”

时效性（Freshness / Timeliness）是搜索里非常容易“用错”的信号。

- 用得好：突发事件/热点查询下，用户满意度大幅提升
- 用不好：常青查询被新内容污染，用户觉得“搜出来全是新闻、答案反而变差”

本章的关键思想是：

> 时效性是一个“意图驱动”的信号：先判断用户需不需要新，再决定新内容加多少权重。

---

## 8.1 三类时效性：突发 / 一般 / 周期

本章把时效性需求分为三类，这个划分非常工程化：

### 8.1.1 突发时效性（Breaking）

特点：

- 热点突然爆发，需求强烈
- 内容生命周期短（小时/天）

例子：重大新闻、突发灾害、体育比赛实时结果。

### 8.1.2 一般时效性（General）

特点：

- 需要较新的信息，但不要求“实时”
- 生命周期较长（周/月）

例子：手机测评、政策解读、版本更新。

### 8.1.3 周期时效性（Periodic）

特点：

- 每隔一段时间重复出现
- 需要在周期点附近优先新内容

例子：高考、春节、双十一、年度榜单。

工程含义：

- 突发：更依赖“热度检测 + 运营/外部信号”
- 一般：更依赖“语义理解 + 时间特征融合”
- 周期：更依赖“日历/周期建模 + 召回策略”

---

## 8.2 突发时效性的检测：日志挖掘 + 站外信号 + 运营预配置

本章给的突发检测思路很实用，典型会用三类信号：

1. **搜索量激增**：query PV/UV 在短时间内显著上升
2. **站内发布激增**：相关主题新文档数量爆发
3. **站外热榜**：微博/新闻/短视频热榜等

以及一个很现实的补丁：

- **运营预配置**：对于可预期事件（发布会、比赛），提前准备规则与词表

这里的工程要点是：

- 突发检测一定要考虑“误报成本”：误判为突发会导致常青 query 被新内容污染
- 多信号一致性比单信号阈值更稳

---

## 8.3 一般时效性：用语义模型判“意图强弱”，再决定加权

本章提到一种很工业化的做法：

- 用语义模型将 query 的时效性意图分为：强/中/弱/无

你可以把它理解为一个 QP 子任务：

- 输入：query
- 输出：用户是否在“要新信息”

工程上这非常关键，因为它决定了排序融合的形状：

- 意图强：新内容权重大，旧内容即使相关也要降权
- 意图弱：新内容只做轻微加权
- 无意图：基本不加新鲜度，防止污染

---

## 8.4 下游承接：索引与召回必须支持“新内容快速可检索”

时效性不是只靠排序加一个时间特征就完事。

如果新内容不能快速进入索引、不能被召回，那排序根本无从加权。

本章强调的一个关键工程点：

- **新文档独立索引（近线/实时索引）**

典型架构是：

- 全量离线索引（稳定、覆盖广）
- 近线/实时索引（更新快、覆盖新内容）

召回时：

- 两路并行召回
- 根据 query 的时效性意图强弱决定配额/混排策略

---

## 8.5 排序融合：时间特征如何进入模型

常见做法是把时间相关特征（例如发布时间 age）加入排序模型，并让模型学习：

- 不同 query 下，age 的权重不同

但如果你没有一个明确的“意图强弱”信号，模型很容易学到平均效果：

- 对突发 query 不够新
- 对常青 query 反而过新

因此本章的建议更像是“先规则分桶，再模型细调”：

- 先把 query 分成强/中/弱/无
- 在不同桶里，使用不同的年龄特征权重/不同的候选配额

---

## 8.6 常见坑与检查清单

- 新鲜度一刀切：常青 query 被新闻污染
- 只用搜索量激增：节假日/平台活动会造成假激增
- 新内容入库慢：突发场景里“慢 10 分钟就是灾难”
- 只排序不召回：新内容根本进不了候选
- 时间特征泄漏：训练/测试切分不当会让离线指标虚高

---

## 8.7 练习（建议动手）

1. 选 100 个 query，人工标注时效性意图（强/中/弱/无），并写出你用的判据。
2. 用日志做一个简单的突发检测：以分钟为粒度算 query PV，做 z-score 或环比阈值检测，观察误报/漏报。
3. 设计一个双索引召回方案：给定 5 万候选预算，你如何在“全量索引 vs 近线索引”之间分配配额，并随意图强弱变化？

---

## 8.8 与其它章节的连接

- 与第 6 章：先相关再新；不能用新替代相关
- 与第 7 章：新内容常更粗糙，质量信号用于抑制低质新内容
- 与第 9 章：本地热点也有突发性（例如城市突发事件），可结合地域性
- 与第 10 章：个性化/CTR 会放大热点，需防止“越点越热”的反馈回路
