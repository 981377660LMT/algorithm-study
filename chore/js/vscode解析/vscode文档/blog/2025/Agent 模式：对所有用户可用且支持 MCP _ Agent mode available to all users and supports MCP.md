# Agent 模式：对所有用户可用且支持 MCP

链接：https://code.visualstudio.com/blogs/2025/04/07/agentMode

## 摘要

2025 年 4 月，VS Code 正式向所有用户推送了“Agent 模式”。与传统的单轮对话不同，Agent 模式允许 Copilot 作为一个自主的协作开发者运行。它可以自动执行多步任务：读取代码、修改文件、运行终端命令、监听编译/Lint 错误并自动进行修复迭代。此外，Agent 模式还引入了对 Model Context Protocol (MCP) 的支持，使 Agent 能够通过通用的工具接口调用外部数据库、API 和本地工具。

## 一针见血的分析

Agent 模式的发布标志着 VS Code 从“辅助编程”迈向了“自主编程”的新阶段。其工程深度体现在**端到端的自动化循环（Loop of Automation）**：Agent 不仅仅在生成代码，它在“感知、思考、行动、复核”的闭环中运行。通过将终端输出和编辑器错误反馈注入到 LLM 的上下文，VS Code 解决了 AI 生成代码“无法运行”或“编译失败”的痛点。更重要的是，**对 MCP 的集成**重现了当年 LSP 的成功路径——通过标准化协议打破 AI 工具与私有数据/环境之间的壁垒。这不仅增强了 Agent 的能力边界，也确保了 VS Code 在 AI 时代依然保持其作为“开放平台驱动者”的核心地位。

## 深入分析

### 1. 从“Copilot”到“Agent”的转折点

Agent 模式的全面铺开标志着 IDE 的核心交互逻辑发生了质变。传统的 Edit 模式倾向于“指令-执行”，而 Agent 模式则具备了**自治循环**能力：它能自动分析代码、运行终端命令、监听错误输出并自我修正。这使得处理复杂、多步骤的重构任务从“手动监工”变为“结果确认”。

### 2. MCP：AI 时代的“USB 接口”

原生支持 MCP (Model Context Protocol) 是本文的重头戏。VS Code 通过 MCP 实现了与外部数据源（如 SQL 数据库、GitHub Issues、Web 浏览器）的标准化链接。这不仅丰富了上下文，更让 IDE 成为了一个**通用控制中枢**。

### 3. 架构统一与确定性控制

VS Code 将 Ask/Edit 模式统一向 Agentic 架构演进，背后是利用 `edit_file` 和 `#codebase` 工具来提升操作精度。同时，通过引入“检查点（Checkpoints）”和“手动审批”机制，在赋予 AI 强大能力的同时，确保了开发者对代码库最终状态的绝对控制权。
