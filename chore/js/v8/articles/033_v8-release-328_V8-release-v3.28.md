# 数组的魔法：展开运算符的性能代价

# V8 release v3.28: Spread operator and array improvements

### 1. 语法优雅，性能承压

支持了 ES6 的数组展开运算符 `[...args]`。
实现机制上，V8 必须处理多种不同的 Iterables 类型。如果展开的是一个标准数组，V8 会走一条预扫描的 Fast Path（基于内存块拷贝）；如果是一个自定义的迭代器，则不得不退化到慢速的函数调用。这提醒开发者：语法的优雅背后，往往伴随着隐形的判别代价。

### 2. 精准的类型反馈

增强了 Inline Caches（IC）对数组元素的类型追踪。V8 能够更好地区分 `SMI_ELEMENTS`（整数）和 `DOUBLE_ELEMENTS`（浮点数），避免由于不必要的类型转换（De-transition）导致 JIT 编译的代码频繁失效。

### 3. 一针见血的见解

ES6 特性的全面铺开意味着 V8 的 **Stub Cache** 必须变得更加智能。在这个版本中，我们可以看到 V8 正在尝试将现代语法的执行逻辑从“纯粹的解释实现”向“高度优化的编译器内置实现（Builtins）”转型。
