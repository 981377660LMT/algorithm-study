# 栈的断裂与重组：Generator 的初步支持

# V8 release v3.19: ES6 Generators and status machine

### 1. 非连续执行流

Generator 的引入标志着 V8 必须能够在一个函数执行到一半时，将其调用栈（Frame）转储到堆内存中，并在稍后重新恢复。
这要求 V8 的 **Stack Guard** 和寄存器分配算法必须支持“非连续”的概念。V8 为此引入了 **Context** 对象的深度绑定，确保在 `yield` 之后恢复执行时，闭包变量和临时中间变量能够精准回位。

### 2. TypedArray 内联支持

此版本进一步将 TypedArray 的各种操作（如 `set` 和 `get`）纳入 Crankshaft 的自动内联范围，消除了大量小型循环中的函数调用开销。

### 3. 一针见血的见解

Generator 的引入标志着 V8 从单纯的“运算加速计”进化为能够处理复杂“状态机”的对象虚拟机。它不再假设代码总是一步到位地运行到底，而是学会了如何优雅地“在时间与堆内存中保存状态”。
