# 类型化的胜利：Typed Array 的全面深度集成

# V8 release v3.13: Deep integration of Typed Arrays

### 1. 从库函数到编译器原语

在早期的 V8 中，Typed Array 曾以 C++ 扩展的形式存在。
在 v3.13 中，它们被彻底整合进 **Crankshaft** 的 **Hydrogen** 编译器。这意味着像 `Int32Array` 的赋值、读取，甚至循环遍历，现在都直接对应到编译器里的单条 SSA（静态单赋值）指令。这种集成让编译器可以在这些操作之间进行更复杂的“公共子表达式消除”（CSE）和“指令重排”。

### 2. 精调数组边界检查

优化了 `Smi`（小整数）在数组索引中的范围检查逻辑，利用分支预测器大幅减少了边界检查产生的 CPU 停顿。

### 3. 一针见血的见解

高性能 JS 的未来在于数据的“平坦化”。v3.13 的工作本质上是在 JS 引擎中构建了一条专门处理“平坦数据”的特快专列，让引擎在面对大规模数值运算时，能像处理 C 语言结构体一样高效。
