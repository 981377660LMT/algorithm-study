# 非回溯正则引擎：根治 ReDoS 的利器

# An additional non-backtracking RegExp engine

V8 在传统的回溯引擎之外，引入了一个全新的非回溯（Non-backtracking）生成引擎，专门用于防御过度的性能开销。

### 1. 核心瓶颈：回溯带来的指数爆炸

传统的 `Irregexp` 引擎使用的是回溯算法。面对某些精心构造的模式（如 `/(a*)*b/`）和特定的输入，其时间复杂度会发生指数级坍塌，导致所谓的“正则拒绝服务攻击”（ReDoS）。

### 2. 技术创新：NFA 与宽度优先遍历

- **算法变迁**：新引擎基于类似 RE2 的算法。
- **锁步执行**：它采用宽度优先的 lock-step 遍历所有可能的匹配状态。
- **复杂度保证**：它能保证匹配时间在最坏情况下也是线性的（$O(M \times N)$，即模式长度乘以输入长度）。

### 3. 一针见血的见解

通过集成备用引擎，V8 建立了一套正则表达式的“容错与保护机制”。当检测到由于回溯可能导致的过高代价时，引擎会自动切换到这个确定性更强的分支，从架构底层彻底消弭了 ReDoS 的安全威胁，体现了安全与性能的深度融合。
