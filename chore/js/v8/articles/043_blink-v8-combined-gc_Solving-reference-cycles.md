# 跨堆引用循环：解决 JS 与 C++ 之间的内存管理困境

# Blink-V8 reference cycles: Solving cross-heap memory issues

在浏览器环境中，V8（JS 堆）和 Blink（DOM 堆/C++）之间的博弈一直是内存泄漏的温床。

### 1. 痛点：JS 与 DOM 的引用泥潭

JS 对象可能持有一个 DOM 包装器，而 DOM 节点又可能通过属性引用回另一个 JS 对象。由于两者位于不同的内存空间且受不同的 GC 机制管辖（V8 GC vs C++ 引用计数/Oilpan），这种跨堆的循环引用在以往是无法被常规 GC 识别并回收的，导致了严重的内存“阴影”。

### 2. 解决方案：联合追踪 (Cross-heap Tracing)

引入了名为 **Combined GC** 的技术。V8 的标记任务现在具备了“视网膜穿透”能力，可以追踪并跨越堆边界进入 Blink。当 V8 发现一个 DOM 子图仅由不可达的 JS 对象持有，且没有其他外部引用时，它能协同 Blink 彻底斩断这条循环连路并安全释放。

### 3. 一针见血的见解

Web 性能不仅取决于 JS 执行，更取决于 JS 与宿主的交互。联合追踪的出现，彻底解决了以往 SPA 应用中“DOM 删了但内存下不来”的隐形炸弹，是 V8 真正理解其作为浏览器核心角色的一项创举。
