# ES6 迭代器与模板字符串：稳健实现的关键

# ES6 Iterators and Template Literals: Foundations of stability

V8 v4.3 正式确立了 ES6 两大核心语法的底层运行标准。

### 1. 迭代器协议 (Symbol.iterator)

`for...of` 和迭代器协议的落地，对 V8 的内联缓存（IC）提出了严峻挑战。因为 `.next()` 调用点的输入类型可能是极其多态的。V8 通过在迭代循环中引入更灵活的类型反馈（Type Feedback），确保了在处理原生数组迭代时能保持单态的高速。

### 2. 模板字面量与标签函数

在处理模板字符串时，解析器将原始字符串与占位符表达式物理分离。为了支持标签函数（Tagged Templates），V8 内部会缓存“原始”内容（Raw strings）以实现单次解析多次使用的效率，避免了重复的字符串拼接开销。

### 3. 一针见血的见解

v4.3 证明了 V8 不再只关注“简单循环”，它开始正面处理 JS 语言日益增长的抽象层次。通过在底层为迭代器和模板字符串铺路，V8 正式向开发者宣告：你可以放心使用这些高级语法而不用担心性能坠毁。
