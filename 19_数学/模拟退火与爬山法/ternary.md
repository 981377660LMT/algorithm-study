**三分法找不到非严格凸函数的最值**
**此时需要二分判断**
E - 11/22 Subsequence
https://atcoder.jp/contests/abc381/tasks/abc381_e

---

三分法（Ternary Search）是一种用于在单峰（单调先增后减或先减后增）的函数中寻找极值（最大值或最小值）的高效算法。尽管三分法在满足特定条件下表现出色，但在某些情况下它可能会失效或产生错误的结果。以下是三分法无效的主要情形及原因：

## **1. 函数不是单峰的（非单调先增后减或先减后增）**

### **解释：**

三分法的核心假设是函数在搜索区间内具有一个明确的极值点，即单峰。如果函数在区间内具有多个极值点（即多峰），三分法可能会陷入局部极值，无法找到全局极值。

### **示例：**

考虑函数 \( f(x) = \sin(x) \) 在区间 \([0, 4\pi]\) 内。该函数有多个极大值和极小值，明显不是单峰函数。使用三分法在这样的区间内搜索极大值，将无法保证找到全局最大值。

## **2. 函数在区间端点处没有极值**

### **解释：**

如果函数的极值恰好位于搜索区间的端点，三分法可能会错过这一点，因为三分法主要在内部区间进行判断和缩小搜索范围。

### **示例：**

考虑函数 \( f(x) = x \) 在区间 \([0, 1]\) 内寻找最大值。显然，最大值在 \( x = 1 \) 处。然而，三分法通过将区间分为三部分进行搜索，可能不会准确识别出端点 \( x = 1 \) 为最大值的位置。

## **3. 函数具有平坦区间（局部极值不明显）**

### **解释：**

如果函数在极值附近存在一个平坦的区域，即多个相邻点的函数值相同，三分法可能无法有效缩小搜索范围，导致算法效率降低或无法收敛。

### **示例：**

考虑函数 \( f(x) = \) 常数函数 \( f(x) = 5 \) 在任意区间内。由于所有点的函数值相同，三分法无法确定一个明确的极值点，从而无法正确工作。

## **4. 函数不是连续的或不可微分**

### **解释：**

三分法依赖于函数的连续性和单调性变化。如果函数在某些点不连续或不可微分，三分法的判断逻辑可能会被破坏，导致错误的搜索方向。

### **示例：**

考虑函数 \( f(x) \) 在 \( x = 2 \) 处有一个跳跃不连续点，如：
\[
f(x) =
\begin{cases}
x^2 & \text{if } x < 2 \\
8 & \text{if } x \geq 2
\end{cases}
\]
在区间 \([1, 3]\) 内使用三分法寻找极大值，函数在 \( x = 2 \) 处突然跳跃，可能导致算法无法正确识别极大值的位置。

## **5. 搜索区间过小或步长过大**

### **解释：**

三分法在每一步将搜索区间缩小为原来的三分之一，因此当搜索区间本身非常小或初始步长设置不当时，算法可能会过早终止，未能找到准确的极值点。

### **示例：**

如果在一个非常狭窄的区间内（如 \([1.999, 2.001]\)）应用三分法，且步长设置过大，可能会导致算法错过真正的极值点，尤其是在极值点位于区间端点时。

## **6. 数据离散或不适用于连续搜索**

### **解释：**

三分法主要适用于连续函数的优化问题。在离散数据或需要在离散点中寻找极值的情况下，三分法可能无法有效应用。

### **示例：**

假设有一组离散的数据点，如数组 \([1, 3, 2, 5, 4]\)，需要找到最大值或最小值。使用三分法在这样的离散点集上进行搜索，不仅复杂且效率低下，而且可能无法准确找到极值。

## **总结**

三分法在解决单峰连续函数的极值问题时非常高效，但其适用性受到函数性质和搜索条件的严格限制。为了确保三分法的有效性，必须确保：

1. **函数必须是单峰的**，即具有一个明确的极值点。
2. **函数在整个搜索区间内必须连续**，且没有平坦或跳跃不连续点。
3. **搜索区间和步长设置适当**，避免过早终止或遗漏极值点。
4. **适用于连续优化问题**，而非离散数据集。

在实际应用中，若不满足上述条件，建议考虑其他优化算法，如动态规划、贪心算法或全局搜索方法（如遗传算法、模拟退火等），以更有效地解决问题。
