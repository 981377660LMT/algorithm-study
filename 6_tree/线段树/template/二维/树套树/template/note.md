参考 maspy 的二维数树状数组和线段树的实现
